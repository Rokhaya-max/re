<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Vidéo en Temps Réel</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
</head>
<body>

    <div id="annonce">
        <p>Bienvenue sur le site de chat vidéo de <strong>Ndeye Rokhaya SIGNATE</strong>. Vos données personnelles sont protégées.</p>
    </div>

    <div id="register">
        <h1>Ton Nom:</h1>
        <form onsubmit="register(); return false;">
            <input type="text" id="name" placeholder="Entrez votre nom" required>
            <input type="submit" value="Rejoindre">
        </form>
    </div>

    <div id="userAdd" style="display: none;">
        <h1>Se Connecter à un autre utilisateur:</h1>
        <form onsubmit="appelUser(); return false;">
            <input type="text" id="add" placeholder="Nom de l'utilisateur" required>
            <input type="submit" value="Ajouter">
        </form>
    </div>

    <div id="userShare" style="display: none;">
        <h1>Partager son écran:</h1>
        <form onsubmit="addScreenShare(); return false;">
            <input type="text" id="share" placeholder="Nom de l'utilisateur" required>
            <input type="submit" value="Partager">
        </form>
    </div>

    <div id="participants"></div>

    <h1>Chat WebSocket</h1>
    <div id="chatbox" aria-live="polite"></div>
    <input type="text" id="messageInput" placeholder="Écrire un message..." aria-label="Écrire un message">
    <button id="sendButton" aria-label="Envoyer le message">Envoyer</button>

    <script>
        const chatbox = document.getElementById('chatbox');
        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendButton');
        
        // Connexion WebSocket sécurisée (environnement de production)
        const socket = new WebSocket('wss://localhost:8080');  // Utilisez 'wss://' pour la sécurité

        // Lorsque le message est reçu du serveur
        socket.onmessage = function(event) {
            const message = event.data;
            const messageElement = document.createElement('p');
            messageElement.textContent = message;
            chatbox.appendChild(messageElement);
            chatbox.scrollTop = chatbox.scrollHeight; // Faire défiler vers le bas
        };

        // Envoi du message
        sendButton.onclick = function() {
            const message = messageInput.value.trim();
            if (message !== "") {
                socket.send(message); // Envoie le message au serveur
                messageInput.value = ""; // Efface le champ de saisie
            } else {
                alert("Veuillez saisir un message avant d'envoyer.");
            }
        };

        // Permet d'envoyer un message avec la touche Entrée
        messageInput.addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                sendButton.click();
            }
        });
    </script>

    <!-- Tawk.to Live Chat Widget -->
    <script type="text/javascript">
        var Tawk_API = Tawk_API || {}, Tawk_LoadStart = new Date();
        (function(){
            var s1 = document.createElement("script"), s0 = document.getElementsByTagName("script")[0];
            s1.async = true;
            s1.src = 'https://embed.tawk.to/YOUR_WIDGET_ID/default';
            s1.charset = 'UTF-8';
            s1.setAttribute('crossorigin', '*');
            s0.parentNode.insertBefore(s1, s0);
        })();
    </script>

</body>
</html>

   